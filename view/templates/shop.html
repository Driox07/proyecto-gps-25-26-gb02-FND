<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda - OverSound</title>
    <link rel="stylesheet" href="{{ url_for('static', path='styles/header.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/shop.css') }}">
</head>
<body>
    {% include 'common/header.html' %}
    
    <div class="shop-container">
        <!-- Header de Tienda -->
        <div class="shop-header">
            <h1>Tienda OverSound</h1>
            <p>Descubre música exclusiva, álbumes y merchandising de tus artistas favoritos</p>
        </div>

        <!-- Filtros y Búsqueda -->
        <div class="shop-controls">
            <div class="search-bar">
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="Buscar canciones, álbumes o artistas..." 
                    class="search-input"
                >
                <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </div>

            <div class="filters">
                <div class="filter-group">
                    <label for="genre-filter">Género:</label>
                    <select id="genre-filter" class="filter-select">
                        <option value="">Todos los géneros</option>
                        {% for genre in genres %}
                            <option value="{{ genre }}">{{ genre }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="filter-group">
                    <label for="artist-filter">Artista:</label>
                    <select id="artist-filter" class="filter-select">
                        <option value="">Todos los artistas</option>
                        {% for artista in artistas %}
                            <option value="{{ artista }}">{{ artista }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="filter-group">
                    <label for="type-filter">Tipo:</label>
                    <select id="type-filter" class="filter-select">
                        <option value="">Todo</option>
                        <option value="cancion">Canciones</option>
                        <option value="album">Álbumes</option>
                        <option value="merch">Merchandising</option>
                    </select>
                </div>

                <button id="reset-filters" class="btn-reset">Limpiar Filtros</button>
            </div>
        </div>

        <!-- Contenedor de Productos -->
        <div class="products-section">
            <div id="loading-indicator" class="loading-indicator" style="display: none;">
                <div class="spinner"></div>
                <p>Cargando productos...</p>
            </div>

            <div id="products-grid" class="products-grid">
                <!-- Canciones -->
                {% for song in songs %}
                    <div class="product-card" data-type="cancion" data-genre="{{ song.get('genero', '') }}" data-artist="{{ song.get('artista', '') }}">
                        <div class="product-image">
                            <img src="{{ song.get('imagen', '/static/images/default-song.png') }}" alt="{{ song.get('nombre', 'Canción') }}">
                            <div class="product-overlay">
                                <a href="/song/{{ song.get('id', '') }}" class="btn-view">Ver Detalles</a>
                            </div>
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">{{ song.get('nombre', 'Sin título') }}</h3>
                            <p class="product-artist">{{ song.get('artista', 'Artista desconocido') }}</p>
                            <p class="product-genre">{{ song.get('genero', '') }}</p>
                            <div class="product-footer">
                                <span class="product-price">€{{ song.get('precio', '0.99') }}</span>
                                <button class="btn-add-cart" data-product-id="{{ song.get('id', '') }}" data-product-type="cancion">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="9" cy="21" r="1"></circle>
                                        <circle cx="20" cy="21" r="1"></circle>
                                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                {% endfor %}

                <!-- Álbumes -->
                {% for album in albums %}
                    <div class="product-card" data-type="album" data-genre="{{ album.get('genero', '') }}" data-artist="{{ album.get('artista', '') }}">
                        <div class="product-image">
                            <img src="{{ album.get('imagen', '/static/images/default-album.png') }}" alt="{{ album.get('nombre', 'Álbum') }}">
                            <div class="product-overlay">
                                <a href="/album/{{ album.get('id', '') }}" class="btn-view">Ver Detalles</a>
                            </div>
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">{{ album.get('nombre', 'Sin título') }}</h3>
                            <p class="product-artist">{{ album.get('artista', 'Artista desconocido') }}</p>
                            <p class="product-genre">Álbum · {{ album.get('genero', '') }}</p>
                            <div class="product-footer">
                                <span class="product-price">€{{ album.get('precio', '9.99') }}</span>
                                <button class="btn-add-cart" data-product-id="{{ album.get('id', '') }}" data-product-type="album">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="9" cy="21" r="1"></circle>
                                        <circle cx="20" cy="21" r="1"></circle>
                                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>

            <!-- Mensaje cuando no hay productos -->
            <div id="no-products" class="no-products" style="display: none;">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                <h3>No se encontraron productos</h3>
                <p>Intenta ajustar tus filtros de búsqueda</p>
            </div>
        </div>

        <!-- Carrito Flotante -->
        <div id="cart-notification" class="cart-notification" style="display: none;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span id="notification-text">Producto añadido al carrito</span>
        </div>
    </div>

    <!-- Footer -->
    <footer class="shop-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>OverSound Tienda</h3>
                <p>La tienda oficial de OverSound. Compra música, álbumes y merchandise exclusivo.</p>
            </div>
            <div class="footer-section">
                <h4>Enlaces Rápidos</h4>
                <ul>
                    <li><a href="/">Inicio</a></li>
                    <li><a href="/artists">Artistas</a></li>
                    <li><a href="/cart">Carrito</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Ayuda</h4>
                <ul>
                    <li><a href="/help">Centro de Ayuda</a></li>
                    <li><a href="/contact">Contacto</a></li>
                    <li><a href="/faq">Preguntas Frecuentes</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 OverSound. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="{{ url_for('static', path='js/shop.js') }}"></script>
</body>
</html>
